{
  "generators": [
    {
      "topic": "events",
      "key": "kafka_connect.events",
      "value": {
        "event_time": {
          "_gen": "now"
        },
        "target_table": {
          "_gen": "oneOf",
          "choices": [
            "kafka_connect_raw.signup_events",
            "kafka_connect_raw.auth_events",
            "kafka_connect_raw.error_events"
          ]
        },
        "user_id": {
          "_gen": "string",
          "expr": "#{Internet.uuid}"
        }
      }
    },


    {
      "topic": "iot-readings",
      "key": "iot-readings",
      "value": {
        "event_time": {
          "_gen": "now"
        },
        "device_type": {
          "_gen": "oneOf",
          "choices": [
            "temperature",
            "pressure",
            "elevation"
          ]
        },
        "device_id": {
          "_gen": "string",
          "expr": "#{Internet.uuid}"
        },
        "reading": {
          "_gen": "normalDistribution",
          "mean": 50,
          "sd": 5
        }
      }
    },
    {
      "topic": "shadow-cdc-events",
      "fork": {
        "key": {
          "_gen": "uuid"
        },
        "stagger": {
          "ms": 500
        }
      },
      "key": {
        "_gen": "var",
        "var": "forkKey"
      },
      "value": {},
      "stateMachine": {
        "_gen": "stateMachine",
        "initial": "insert",
        "merge": {
          "previous": true
        },
        "transitions": {
          "insert": {
            "_gen": "weightedOneOf",
            "choices": [
              {
                "weight": 4,
                "value": "update"
              },
              {
                "weight": 1,
                "value": "delete"
              }
            ]
          },
          "update": {
            "_gen": "oneOf",
            "choices": [
              "update",
              "delete"
            ]
          },
          "delete": "insert"
        },
        "states": {
          "insert": {
            "value": {
              "op": "c",
              "payload": {
                "before": null,
                "after": {
                  "id": {
                    "_gen": "var",
                    "var": "forkKey"
                  },
                  "firstName": {
                    "_gen": "string",
                    "expr": "#{Name.first_name}"
                  },
                  "lastName": {
                    "_gen": "string",
                    "expr": "#{Name.last_name}"
                  },
                  "email": {
                    "_gen": "string",
                    "expr": "#{Internet.email_address}"
                  }
                }
              }
            }
          },
          "update": {
            "value": {
              "op": "u",
              "payload": {
                "before": {
                  "_gen": "previousEvent",
                  "path": [
                    "value",
                    "payload",
                    "after"
                  ]
                },
                "after": {
                  "_gen": "someKeys",
                  "object": {
                    "firstName": {
                      "_gen": "string",
                      "expr": "#{Name.first_name}"
                    },
                    "lastName": {
                      "_gen": "string",
                      "expr": "#{Name.last_name}"
                    },
                    "email": {
                      "_gen": "string",
                      "expr": "#{Internet.email_address}"
                    }
                  }
                }
              }
            }
          },
          "delete": {
            "value": {
              "op": "d",
              "payload": {
                "before": {
                  "_gen": "previousEvent",
                  "path": [
                    "value",
                    "payload",
                    "after"
                  ]
                },
                "after": null
              }
            }
          }
        }
      },
      "localConfigs": {
        "throttle": {
          "ms": 250
        }
      }
    },
    {
      "topic": "memory_usage",
      "fork": {
        "key": {
          "_gen": "sequentialString",
          "expr": "jvm-~d"
        },
        "maxForks": 30,
        "stagger": {
          "ms": 2000
        }
      },
      "key": {
        "jvmId": {
          "_gen": "var",
          "var": "forkKey"
        }
      },
      "value": {
        "timestamp": {
          "_gen": "now"
        }
      },
      "stateMachine": {
        "_gen": "stateMachine",
        "initial": "start",
        "transitions": {
          "start": "update",
          "update": "update"
        },
        "states": {
          "start": {
            "value": {
              "heapSize": {
                "_gen": "normalDistribution",
                "mean": 50,
                "sd": 5
              }
            }
          },
          "update": {
            "value": {
              "heapSize": {
                "_gen": "add",
                "args": [
                  {
                    "_gen": "uniformDistribution",
                    "bounds": [
                      -1,
                      1
                    ]
                  },
                  {
                    "_gen": "previousEvent",
                    "path": [
                      "value",
                      "heapSize"
                    ]
                  }
                ]
              }
            }
          }
        }
      },
      "localConfigs": {
        "throttle": {
          "ms": 250
        }
      }
    }
  ],
  "connections": {
    "kafka": {
      "kind": "kafka",
      "producerConfigs": {
        "bootstrap.servers": "kafka:9092",
        "key.serializer": "io.shadowtraffic.kafka.serdes.JsonSerializer",
        "value.serializer": "io.shadowtraffic.kafka.serdes.JsonSerializer"
      }
    }
  }
}